import{Injectable}from"@angular/core";import{HttpClient,HttpEventType,HttpRequest,HttpResponse}from"@angular/common/http";var ThfUploadBaseService=function(){function e(e){this.http=e,this.requests=[]}return e.prototype.upload=function(e,t,r,s,o,i){for(var n=t.length,a={data:{},file:null},p=0;p<n;p++){var u=new FormData,f=t[p];u.append("files",f.rawFile),r&&(a.file=f,r.emit(a),u.append("data",JSON.stringify(a.data))),this.sendFile(e,f,u,s,o,i)}},e.prototype.sendFile=function(e,t,r,s,o,i){var n=this,a=this.getRequest(e,r).subscribe(function(e){if(e.type===HttpEventType.UploadProgress){n.addRequest(t,a);var r=Math.round(100*e.loaded/e.total);s(t,r)}else e instanceof HttpResponse&&o(t,e)},function(e){i(t,e)})},e.prototype.getRequest=function(e,t){var r=new HttpRequest("POST",e,t,{reportProgress:!0});return this.http.request(r)},e.prototype.stopRequestByFile=function(e,t){var r=this.requests.find(function(t){return t.file.uid===e.uid});if(r){r.request.unsubscribe(),this.removeRequest(r),t()}},e.prototype.removeRequest=function(e){var t=this.requests.indexOf(e);this.requests.splice(t,1)},e.prototype.addRequest=function(e,t){this.requests.some(function(t){return t.file.uid===e.uid})||this.requests.push({file:e,request:t})},e.decorators=[{type:Injectable}],e.ctorParameters=function(){return[{type:HttpClient}]},e}();export{ThfUploadBaseService};function ThfUploadBaseService_tsickle_Closure_declarations(){ThfUploadBaseService.decorators,ThfUploadBaseService.ctorParameters,ThfUploadBaseService.prototype.requests,ThfUploadBaseService.prototype.http}