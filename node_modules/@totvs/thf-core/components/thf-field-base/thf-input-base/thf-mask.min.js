var ThfMask=function(){function t(t,i){this.mask="",this.formatModel=!1,this.initialPosition=0,this.finalPosition=0,this.pattern="",this.keypress=function(t){},this.mask=t,this.formatModel=i,this.pattern=this.getRegexFromMask(t)}return Object.defineProperty(t.prototype,"getPattern",{get:function(){return this.pattern},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"getValueToInput",{get:function(){return this.valueToInput},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"setValueToInput",{set:function(t){this.valueToInput=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"getValueToModel",{get:function(){return this.valueToModel},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"setValueToModel",{set:function(t){this.valueToModel=t},enumerable:!0,configurable:!0}),t.prototype.keyup=function(t){if(this.mask){var i=t.target.value;switch(17!==t.keyCode&&91!==t.keyCode||(t.target.value=this.controlFormatting(i),this.resetPositions(t)),t.preventDefault(),t.keyCode){case 37:this.initialPosition>0&&this.initialPosition--,this.setPositionNotShiftKey(t),this.setSelectionRange(t);break;case 39:this.initialPosition<i.toString().length&&this.initialPosition++,this.setPositionNotShiftKey(t),this.setSelectionRange(t);break;case 35:this.finalPosition=i.toString().length,t.shiftKey?this.setPositions(t):(this.initialPosition=this.finalPosition,this.setPositions(t));break;case 36:t.shiftKey?(this.finalPosition=this.initialPosition,this.initialPosition=0,this.setPositions(t)):(this.initialPosition=0,this.finalPosition=0,this.setPositions(t))}}},t.prototype.setPositionNotShiftKey=function(t){t.shiftKey||(this.finalPosition=this.initialPosition)},t.prototype.setSelectionRange=function(t){this.initialPosition>this.finalPosition?t.target.setSelectionRange(this.finalPosition,this.initialPosition):t.target.setSelectionRange(this.initialPosition,this.finalPosition)},t.prototype.keydown=function(t){if(this.mask){var i=t.target.value;if(9===t.keyCode)return;if(t.ctrlKey||t.metaKey||t.preventDefault(),t.ctrlKey||t.metaKey&&86!==t.keyCode||t.keyCode>=37&&t.keyCode<=40||16===t.keyCode||9===t.keyCode)return;if(this.isKeyValid(t.keyCode))switch(null===this.finalPosition&&(this.finalPosition=this.initialPosition),this.revertPositions(this.initialPosition,this.finalPosition),t.keyCode){case 8:this.getPosition(t),this.initialPosition<0&&(this.initialPosition=0,this.setPositions(t)),this.initialPosition===this.finalPosition?(this.checkMaskBefore(t,-1),0!==this.initialPosition&&(i=i.slice(0,this.initialPosition-1)+i.slice(this.finalPosition),i=this.controlFormatting(i),t.target.value=i,this.changePosition(t,-1),this.checkMaskBefore(t,-1),this.setPositions(t),this.resetPositions(t))):this.clearRangeSelection(i,t,!0),this.setPositions(t);break;case 46:this.getPosition(t),this.initialPosition===this.finalPosition?(this.checkMaskAfter(t,1),i=i.slice(0,this.initialPosition)+i.slice(this.finalPosition+1),i=this.controlFormatting(i),t.target.value=i,this.setPositions(t),this.resetPositions(t)):this.clearRangeSelection(i,t,!1),this.setPositions(t);break;default:i=i.slice(0,this.initialPosition)+t.key+i.slice(this.finalPosition),i=this.controlFormatting(i),t.target.value=i,this.changePosition(t,1),this.checkMaskBefore(t,1),this.setPositions(t),this.resetPositions(t),this.setPositions(t)}}},t.prototype.clearRangeSelection=function(t,i,e){t=t.slice(0,this.initialPosition)+t.slice(this.finalPosition),t=this.controlFormatting(t),i.target.value=t,e&&this.checkMaskBefore(i,-1),this.setPositions(i),this.resetPositions(i)},t.prototype.click=function(t){this.initialPosition=t.target.selectionStart,this.finalPosition=t.target.selectionEnd},t.prototype.blur=function(t){if(this.mask){var i=t.target.value;i=this.controlFormatting(i),t.target.value=i}},t.prototype.revertPositions=function(t,i){if(t>i){var e=void 0;e=t,this.initialPosition=i,this.finalPosition=e}},t.prototype.resetPositions=function(t){this.initialPosition=t.target.selectionStart,this.finalPosition=this.initialPosition},t.prototype.setPositions=function(t){t.target.setSelectionRange(this.initialPosition,this.finalPosition)},t.prototype.changePosition=function(t,i){this.initialPosition=this.initialPosition+i,this.finalPosition=this.finalPosition+i,this.setPositions(t)},t.prototype.getPosition=function(t){this.initialPosition=t.target.selectionStart,this.finalPosition=t.target.selectionEnd,this.setPositions(t)},t.prototype.controlFormatting=function(t){if(!t)return this.valueToInput="",this.valueToModel="","";for(var i,e=this.mask,o=[],s=0;this.hasOptionalNumber(e);)o.push(e),e=this.replaceOptionalNumber(e);for(o.push(e),o.reverse(),this.formattingEnds=!1;!this.formattingEnds&&(this.formattingEnds=!0,o[s]);)i=this.formatValue(t,o[s]),s++;return i},t.prototype.formatValue=function(t,i){var e=(i=i.replace(/\?/g,"")).replace(this.listValidKeys(),"_"),o=0,s="";t=this.removeFormattingValue(t);for(var n=0;n<t.length;n++){var a=t[n];if(!e[o]){this.formattingEnds=!1;break}for(;this.isFixedCharacterGuide(e[o])&&e[o];)s+=e[o],o++;if(!this.isKeyValidMask(a,i[o]))break;s+=a,o++}return this.formatModel?(this.valueToInput=s,this.valueToModel=s):(this.valueToInput=s,this.valueToModel=this.removeFormattingValue(s)),s},t.prototype.checkMaskBefore=function(t,i){this.isFixedCharacterGuide(t.target.value.toString().charAt(this.initialPosition-1))&&(this.changePosition(t,i),this.checkMaskBefore(t,i))},t.prototype.checkMaskAfter=function(t,i){this.isFixedCharacterGuide(t.target.value.toString().charAt(this.initialPosition))&&(this.changePosition(t,i),this.checkMaskAfter(t,i))},t.prototype.replaceOptionalNumber=function(t){for(var i=9;i>=0;){if(t.indexOf(i+"?")>-1)return t.replace(i+"?","");i--}return t},t.prototype.isFixedCharacterGuide=function(t){return this.testRegex(t,this.getFixedCharacterGuide())},t.prototype.getFixedCharacterGuide=function(){return/[\\\/() +-.\:]/g},t.prototype.listValidKeys=function(){return/[a-zA-Z0-9]/g},t.prototype.isKeyValid=function(t){return this.isKeyCodeValid(t)},t.prototype.isKeyCodeValid=function(t){return t>=48&&t<=57||t>=65&&t<=90||t>=96&&t<=105||8===t||9===t||46===t},t.prototype.isKeyValidMask=function(t,i){return this.testRegex(t,this.replaceMask(i))},t.prototype.testRegex=function(t,i){return i.test(t)},t.prototype.removeFormattingValue=function(t){return t.replace(this.getFixedCharacterGuide(),"")},t.prototype.hasOptionalNumber=function(t){return t.match(/\d\?/g)},t.prototype.replaceMask=function(t){var i=/./;switch(t){case"0":i=/[0]/;break;case"1":i=/[0-1]/;break;case"2":i=/[0-2]/;break;case"3":i=/[0-3]/;break;case"4":i=/[0-4]/;break;case"5":i=/[0-5]/;break;case"6":i=/[0-6]/;break;case"7":i=/[0-7]/;break;case"8":i=/[0-8]/;break;case"9":i=/[0-9]/;break;case" ":i=/\s/;break;case"@":i=/[a-zA-Z]/;break;case"w":i=/[a-zA-Z0-9]/}return i},t.prototype.getRegexFromMask=function(t){return this.formatModel?t.replace(/\\/g,"\\\\").replace(/\+/g,"\\+").replace(/\./g,"\\.").replace(/-/g,"-").replace(/\(/g,"\\(").replace(/\)/g,"\\)").replace(/\//g,"\\/").replace(/\s/g,"\\s").replace(/:/g,"\\:").replace(/\@(?!\s)/g,"\\w").replace(/\d/g,"\\w"):t.replace(/\\/g,"").replace(/\+/g,"").replace(/\./g,"").replace(/-/g,"").replace(/\(/g,"").replace(/\)/g,"").replace(/\//g,"").replace(/\s/g,"").replace(/:/g,"").replace(/\@/g,"\\w").replace(/\d/g,"\\w")},t}();export{ThfMask};function ThfMask_tsickle_Closure_declarations(){ThfMask.prototype.mask,ThfMask.prototype.formatModel,ThfMask.prototype.initialPosition,ThfMask.prototype.finalPosition,ThfMask.prototype.pattern,ThfMask.prototype.valueToInput,ThfMask.prototype.valueToModel,ThfMask.prototype.formattingEnds,ThfMask.prototype.keypress}