import{ElementRef,EventEmitter,HostListener,Input,Optional,Output,ViewChild}from"@angular/core";import{NgControl,Validators}from"@angular/forms";import{convertToBoolean}from"./../../../utils/index";import{ThfMask}from"./thf-mask";var ThfInputBaseComponent=function(){function t(t,e){this.placeholder="",this.disabled=!1,this.readonly=!1,this.required=!1,this.focus=!1,this.clean="",this.errorPattern="",this.mask="",this.maskFormatModel=!1,this.blur=new EventEmitter,this.enter=new EventEmitter,this.change=new EventEmitter,this.changeModel=new EventEmitter,this.type="text",this.validators={},this.onChangePropagate=null,this.onTouched=null,this.fireChange=!1,this.el=t,this.ngControl=e}return Object.defineProperty(t.prototype,"setName",{set:function(t){this.name=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"setDisabled",{set:function(t){this.disabled=""===t||convertToBoolean(t),this.validators.required=this.getValidatorRequired(),this.updateValidators()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"setReadonly",{set:function(t){this.readonly=""===t||convertToBoolean(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"setRequired",{set:function(t){this.required=""===t||convertToBoolean(t),this.validators.required=this.getValidatorRequired(),this.updateValidators()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"setFocus",{set:function(t){this.focus=""===t||convertToBoolean(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"setClean",{set:function(t){this.clean="null"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"setPattern",{set:function(t){this.pattern=t,this.validators.pattern=this.getValidatorPattern(),this.updateValidators()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"setMaxlength",{set:function(t){isNaN(parseInt(t,10))?void 0===t&&(this.maxlength=void 0,this.validators.maxlength=this.getValidatorMaxlength(),this.updateValidators()):(this.maxlength=parseInt(t,10),this.validators.maxlength=this.getValidatorMaxlength(),this.updateValidators())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"setMinlength",{set:function(t){isNaN(parseInt(t,10))?void 0===t&&(this.minlength=void 0,this.validators.minlength=this.getValidatorMinlength(),this.updateValidators()):(this.minlength=parseInt(t,10),this.validators.minlength=this.getValidatorMinlength(),this.updateValidators())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"setMask",{set:function(t){this.mask=t,this.objMask instanceof ThfMask&&(this.objMask=new ThfMask(this.mask,this.maskFormatModel),this.validators.pattern=this.getValidatorPattern(),this.updateValidators())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"setMaskFormatModel",{set:function(t){this.maskFormatModel=""===t||convertToBoolean(t)},enumerable:!0,configurable:!0}),t.prototype.ngOnInit=function(){this._onInit()},t.prototype.ngAfterViewInit=function(){this._afterViewInit()},t.prototype._onInit=function(){this.objMask=new ThfMask(this.mask,this.maskFormatModel),this.setValidators()},t.prototype._afterViewInit=function(){this.focus&&this.inputEl.nativeElement.focus(),this.clean&&(this.inputEl.nativeElement.style.paddingRight="30px")},t.prototype.setValidators=function(){this.ngControl&&(this.ngControl.valueAccessor=this,this.validators={},this.validators.required=this.getValidatorRequired(),this.validators.pattern=this.getValidatorPattern(),this.validators.minlength=this.getValidatorMinlength(),this.validators.maxlength=this.getValidatorMaxlength(),this.updateValidators())},t.prototype.getValidatorRequired=function(){return!this.disabled&&this.required?Validators.required:null},t.prototype.getValidatorPattern=function(){if(this.pattern)return Validators.pattern(this.pattern);if(this.mask){var t=this.objMask.getRegexFromMask(this.mask);return Validators.pattern(t)}return null},t.prototype.getValidatorMinlength=function(){return this.minlength?Validators.minLength(this.minlength):null},t.prototype.getValidatorMaxlength=function(){return this.maxlength?Validators.maxLength(this.maxlength):null},t.prototype.updateValidators=function(){this.ngControl&&(this.ngControl.control.setValidators(this.convertObjectToArray(this.validators)),this.ngControl.control.updateValueAndValidity())},t.prototype.convertObjectToArray=function(t){var e=[];return Object.keys(t).forEach(function(n){t[n]&&e.push(t[n])}),e},t.prototype.onKeyup=function(t){this.mask&&(229!==t.target.keyCode&&(this.eventOnBlur(t),this.objMask.keyup(t)),this.callOnChange(this.objMask.valueToModel))},t.prototype.onKeypress=function(t){this.objMask.keypress(t)},t.prototype.onKeydown=function(t){this.mask&&229!==t.target.keyCode&&(this.eventOnBlur(t),this.objMask.keydown(t))},t.prototype.hasInvalidClass=function(){return this.el.nativeElement.classList.contains("ng-invalid")&&this.el.nativeElement.classList.contains("ng-dirty")&&""!==this.inputEl.nativeElement.value},t.prototype.cleanInput=function(){var t=!1;this.fireChange=!1,""!==this.inputEl.nativeElement.value&&(t=!0),this.inputEl.nativeElement.value="",""!==this.clean&&this.callOnChange(""),t&&this.change.emit()},t.prototype.eventOnInput=function(t){this.mask||(this.maxlength&&t.target.value.length>this.maxlength&&(t.target.value=t.target.value.toString().substring(0,this.maxlength)),this.callOnChange(t.target.value))},t.prototype.eventOnFocus=function(t){this.valueBeforeChange=this.inputEl.nativeElement.value,this.enter.emit()},t.prototype.eventOnBlur=function(t){var e=this;this.objMask.blur(t),this.blur.emit(),this.inputEl.nativeElement.value!==this.valueBeforeChange&&(this.fireChange=!0,setTimeout(function(){e.fireChange&&e.change.emit()},200))},t.prototype.verifyPattern=function(t,e){return new RegExp(t).test(e)},t.prototype.eventOnClick=function(t){this.mask&&this.objMask.click(t)},t.prototype.writeValue=function(t){this.inputEl&&(t?this.mask?(this.inputEl.nativeElement.value=this.objMask.controlFormatting(String(t)),this.objMask._formatModel&&this.onChangePropagate(this.objMask.valueToModel)):this.inputEl.nativeElement.value=t:this.inputEl.nativeElement.value=""),t&&this.change.emit()},t.prototype.callOnChange=function(t){this.onChangePropagate&&("number"===this.type?this.onChangePropagate(Number(t)):this.onChangePropagate(t)),this.modelLastUpdate!==t&&(this.changeModel.emit(),this.modelLastUpdate=t)},t.prototype.registerOnChange=function(t){this.onChangePropagate=t},t.prototype.registerOnTouched=function(t){this.onTouched=t},t.ctorParameters=function(){return[{type:ElementRef},{type:NgControl,decorators:[{type:Optional}]}]},t.propDecorators={setName:[{type:Input,args:["name"]}],placeholder:[{type:Input,args:["t-placeholder"]}],setDisabled:[{type:Input,args:["t-disabled"]}],setReadonly:[{type:Input,args:["t-readonly"]}],setRequired:[{type:Input,args:["t-required"]}],setFocus:[{type:Input,args:["t-focus"]}],setClean:[{type:Input,args:["t-clean"]}],setPattern:[{type:Input,args:["t-pattern"]}],errorPattern:[{type:Input,args:["t-error-pattern"]}],setMaxlength:[{type:Input,args:["t-maxlength"]}],setMinlength:[{type:Input,args:["t-minlength"]}],setMask:[{type:Input,args:["t-mask"]}],setMaskFormatModel:[{type:Input,args:["t-mask-format-model"]}],blur:[{type:Output,args:["t-blur"]}],enter:[{type:Output,args:["t-enter"]}],change:[{type:Output,args:["t-change"]}],changeModel:[{type:Output,args:["t-change-model"]}],inputEl:[{type:ViewChild,args:["inp",{read:ElementRef}]}],cleanEl:[{type:ViewChild,args:["clean",{read:ElementRef}]}],onKeyup:[{type:HostListener,args:["keyup",["$event"]]}],onKeypress:[{type:HostListener,args:["keypress",["$event"]]}],onKeydown:[{type:HostListener,args:["keydown",["$event"]]}]},t}();export{ThfInputBaseComponent};function ThfInputBaseComponent_tsickle_Closure_declarations(){ThfInputBaseComponent.ctorParameters,ThfInputBaseComponent.propDecorators,ThfInputBaseComponent.prototype.name,ThfInputBaseComponent.prototype.placeholder,ThfInputBaseComponent.prototype.disabled,ThfInputBaseComponent.prototype.readonly,ThfInputBaseComponent.prototype.required,ThfInputBaseComponent.prototype.focus,ThfInputBaseComponent.prototype.clean,ThfInputBaseComponent.prototype.pattern,ThfInputBaseComponent.prototype.errorPattern,ThfInputBaseComponent.prototype.maxlength,ThfInputBaseComponent.prototype.minlength,ThfInputBaseComponent.prototype.mask,ThfInputBaseComponent.prototype.maskFormatModel,ThfInputBaseComponent.prototype.blur,ThfInputBaseComponent.prototype.enter,ThfInputBaseComponent.prototype.change,ThfInputBaseComponent.prototype.changeModel,ThfInputBaseComponent.prototype.inputEl,ThfInputBaseComponent.prototype.cleanEl,ThfInputBaseComponent.prototype.type,ThfInputBaseComponent.prototype.validators,ThfInputBaseComponent.prototype.ngControl,ThfInputBaseComponent.prototype.onChangePropagate,ThfInputBaseComponent.prototype.onTouched,ThfInputBaseComponent.prototype.el,ThfInputBaseComponent.prototype.objMask,ThfInputBaseComponent.prototype.valueBeforeChange,ThfInputBaseComponent.prototype.modelLastUpdate,ThfInputBaseComponent.prototype.fireChange}