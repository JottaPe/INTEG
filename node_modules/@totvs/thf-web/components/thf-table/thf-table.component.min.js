import{Component,Input,ElementRef,ViewContainerRef}from"@angular/core";import{Output,EventEmitter,Renderer}from"@angular/core";var ThfTableComponent=function(){function t(t,e,o){this.viewRef=o,this.actions=[],this.showMoreDisabled=!1,this.showMore=new EventEmitter,this.selectAll=!1,this.parentRef=o._view.component,this.myElement=t}return t.prototype.selectAllRows=function(){var t=this;this.selectAll=!this.selectAll,this.items.forEach(function(e){e.$selected=t.selectAll})},t.prototype.selectRow=function(t){t.$selected=!t.$selected,this.selectAll=this.items.filter(function(t){return t.$selected}).length===this.items.length},t.prototype.toggleRowAction=function(t){var e=t.$showAction;this.items.forEach(function(t){t.$showAction&&(t.$showAction=!1)}),t.$showAction=!e},t.prototype.sortColumn=function(t){if(this.sort){var e=this.myElement.nativeElement.querySelector("#sort-"+t.column);e.classList.contains("thf-table-header-icon-unselected")||e.classList.contains("thf-table-header-icon-ascending")?(e.className="thf-table-header-icon-descending",this.sortArray(t,!0)):(e.className="thf-table-header-icon-ascending",this.sortArray(t,!1)),this.clearSortingElement(t)}},t.prototype.clearSortingElement=function(t){for(var e=0;e<this.columns.length;e++){var o=this.columns[e];o.column!==t.column&&(this.myElement.nativeElement.querySelector("#sort-"+o.column).className="thf-table-header-icon-unselected")}},t.prototype.parseDate=function(t){var e;return t.indexOf("-")>=0?(e=t.split("-"),new Date(e[0],e[1]-1,e[2])):t.indexOf("/")>=0?(e=t.split("/"),new Date(e[2],e[1]-1,e[0])):null},t.prototype.sortValidate=function(t,e,o){if(o){if(t<e)return-1;if(t>e)return 1}else{if(t<e)return 1;if(t>e)return-1}return 0},t.prototype.sortArray=function(t,e){var o=this;this.items.sort(function(n,l){if("date"===t.type){var c=o.parseDate(n[t.column]).getTime(),s=o.parseDate(l[t.column]).getTime();return o.sortValidate(c,s,e)}if(e){if(n[t.column]<l[t.column])return-1;if(n[t.column]>l[t.column])return 1}else{if(n[t.column]<l[t.column])return 1;if(n[t.column]>l[t.column])return-1}return 0})},t.prototype.onShowMore=function(){this.showMore.emit(null)},t.decorators=[{type:Component,args:[{selector:"thf-table",template:'<table class="thf-table"> <thead> <tr class="thf-table-header"> <th *ngIf="checkbox" class="thf-table-header-ellipsis thf-table-column-checkbox"> <input type="checkbox" class="thf-table-checkbox" [ngClass]="{ \'thf-table-checkbox-checked\': selectAll }"> <label class="thf-table-checkbox-label" (click)="selectAllRows()"></label> </th> <th *ngFor="let column of columns" class="thf-table-header-ellipsis" [style.width]="column.width" [ngClass]="{ \'thf-clickable\': sort, \'thf-table-column-right\': column.type == \'currency\' || column.type == \'number\' }" (click)="sortColumn(column)"> <span id="sort-{{column.column}}" *ngIf="sort"  class=\'thf-table-header-icon-unselected\'></span> <span class="thf-table-header-ellipsis thf-table-header-block">{{ column.label }}</span> </th> <th *ngIf="actions.length > 0" class="thf-table-header-action"></th> </tr> </thead> <tbody> <tr *ngFor="let row of items, let rowIndex = index;" class="thf-table-row"> <td *ngIf="checkbox" class="thf-table-column thf-table-column-checkbox" [ngClass]="{ \'thf-table-row-active\': row.$selected && checkbox }"> <input type="checkbox" class="thf-table-checkbox" [ngClass]="{ \'thf-table-checkbox-checked\': row.$selected }"> <label class="thf-table-checkbox-label" (click)="selectRow(row)"></label> </td> <td *ngFor="let column of columns, let columnIndex = index;" [ngClass]="{ \'thf-table-row-active\': row.$selected && checkbox , \'thf-table-column-right\': column.type == \'currency\' || column.type == \'number\', \'thf-table-main-column\': columnIndex == 0 , \'thf-table-column\': columnIndex > 0 }"> <div [ngSwitch]="column.type"> <span *ngSwitchCase="\'currency\'">{{ row[column.column] | currency:column.format:true:\'1.2-2\' }}</span> <span *ngSwitchCase="\'date\'">{{ row[column.column] | date: (column.format ? column.format : \'dd/MM/yyyy\') }}</span> <span *ngSwitchDefault>{{ row[column.column] }}</span> </div> </td> <td *ngIf="actions.length > 0" class="thf-table-column-actions" [ngClass]="{\'thf-table-row-active\': row.$selected && checkbox }"> <span class="thf-icon thf-icon-more thf-clickable " (click)="toggleRowAction(row)"></span> <div [style.display]="row.$showAction ? \'block\': \'none\'" class="thf-table-actions"> <div *ngFor="let action of actions" class="thf-table-action" (click)="parentRef[action.function](row); toggleRowAction(row)"> {{ action.label }} </div> </div> </td> </tr> </tbody> <tfoot *ngIf="showMore.observers.length > 0"> <tr> <td class="thf-table-footer" [colSpan]="(columns.length) + (actions.length > 0 ? 1 : 0) + ( checkbox ? 1 : 0)"> <thf-button t-label="Carregar mais resultados" t-id="btnShowMoreId" (t-click)="onShowMore()" [t-disabled]="showMoreDisabled"> </thf-button> </td> </tr> </tfoot> </table> '}]}],t.ctorParameters=function(){return[{type:ElementRef},{type:Renderer},{type:ViewContainerRef}]},t.propDecorators={items:[{type:Input,args:["t-items"]}],columns:[{type:Input,args:["t-columns"]}],checkbox:[{type:Input,args:["t-checkbox"]}],actions:[{type:Input,args:["t-actions"]}],sort:[{type:Input,args:["t-sort"]}],showMoreDisabled:[{type:Input,args:["t-show-more-disabled"]}],showMore:[{type:Output,args:["t-show-more"]}]},t}();export{ThfTableComponent};function ThfTableComponent_tsickle_Closure_declarations(){ThfTableComponent.decorators,ThfTableComponent.ctorParameters,ThfTableComponent.propDecorators,ThfTableComponent.prototype.items,ThfTableComponent.prototype.columns,ThfTableComponent.prototype.checkbox,ThfTableComponent.prototype.actions,ThfTableComponent.prototype.sort,ThfTableComponent.prototype.showMoreDisabled,ThfTableComponent.prototype.showMore,ThfTableComponent.prototype.selectAll,ThfTableComponent.prototype.clickListener,ThfTableComponent.prototype.parentRef,ThfTableComponent.prototype.myElement,ThfTableComponent.prototype.viewRef}