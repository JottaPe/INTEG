var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t])};return function(n,t){e(n,t);function i(){this.constructor=n}n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}();import{Component,ElementRef,ViewContainerRef}from"@angular/core";import{Router,NavigationEnd}from"@angular/router";import{Location}from"@angular/common";import{ThfMenuBaseComponent}from"@totvs/thf-core/components/thf-menu-base";var ThfMenuComponent=function(e){__extends(n,e);function n(n,t,i,o){var u=e.call(this)||this;return u.elementRef=n,u.viewRef=t,u.location=i,u.router=o,u.parentRef=t._view.component,u.router.events.subscribe(function(e){e instanceof NavigationEnd&&u.checkActiveMenuByUrl(u.location.path())}),u}return n.prototype.ngOnInit=function(){var e=this;this.validateMenus(),setTimeout(function(){e.checkActiveMenuByUrl(e.location.path())})},n.prototype.validateMenus=function(){this.menus.forEach(function(e){if(""===e.label.trim())throw new Error("O atributo ThfMenuItem.label não pode ser vazio.");e.subItems&&e.subItems.forEach(function(e){if(""===e.label.trim())throw new Error("O atributo ThfMenuItem.label não pode ser vazio.")})})},n.prototype.clickMenuItem=function(e){this.menuMobileOpened=!1,this.isExternalLink(e.link)&&this.openExternalLink(e.link),e.action&&this.executeMenuAction(e),e.link&&!this.isExternalLink(e.link)&&(this.menuItemActive=e,this.menuItemOpened=void 0)},n.prototype.clickMenuItemGrouped=function(e){this.menuItemOpened=this.menuItemOpened===e?void 0:e},n.prototype.clickSubMenuItem=function(e){this.menuMobileOpened=!1,this.isExternalLink(e.link)&&this.openExternalLink(e.link),e.action&&this.executeMenuAction(e),e.link&&!this.isExternalLink(e.link)&&(this.menuItemActive=e)},n.prototype.toggleMenuMobile=function(){this.menuMobileOpened=!this.menuMobileOpened},n.prototype.isMenuItemSelected=function(e){return this.menuItemActive===e&&this.menuItemActive!==this.menuItemOpened||e!==this.menuItemOpened&&e.subItems&&e.subItems.includes(this.menuItemActive)},n.prototype.checkActiveMenuByUrl=function(e){this.linkActive&&this.linkActive===e||this.setActiveMenuByUrl(e)},n.prototype.checkUrl=function(e){var n="";return e.link&&(n=e.link.replace(/^(\.)+/g,"")),n.startsWith("/")||(n="/".concat(n)),n},n.prototype.setActiveMenuByUrl=function(e){var n=this;this.menus.some(function(t){if(n.checkUrl(t)===e)return setTimeout(function(){n.menuItemActive=t,n.linkActive=n.menuItemActive.link,n.menuItemOpened=void 0}),!0;if(t.subItems){var i=t.subItems.find(function(t){return n.checkUrl(t)===e});i&&setTimeout(function(){return n.menuItemActive=i,n.menuItemOpened=t,n.linkActive=n.menuItemActive.link,!0})}})},n.prototype.executeMenuAction=function(e){"string"==typeof e.action?this.parentRef[e.action](e):e.action.call(this.parentRef,e)},n.prototype.openExternalLink=function(e){window.open(e,"_blank")},n.prototype.isExternalLink=function(e){if(e)return e.startsWith("http")},n.decorators=[{type:Component,args:[{selector:"thf-menu",template:'<div *ngIf="menuMobileOpened" class="thf-menu-overlay" (click)="toggleMenuMobile()"></div> <div class="thf-menu-mobile thf-clickable" (click)="toggleMenuMobile()"> <span class="thf-icon thf-icon-menu"></span> </div> <div class="thf-menu" [ngClass]="{ \'thf-menu-animation\' : menuMobileOpened }"> <a href="/" class="thf-menu-logo-container"> <div class="thf-menu-logo"></div> </a> <nav class="thf-menu-container"> \x3c!-- Inner e outer para esconder scroll --\x3e <div class="thf-menu-outer"> <div class="thf-menu-inner"> <div *ngFor="let menu of menus" class="thf-menu-item-wrapper"> \x3c!-- item de menu não selecionado sem agrupamento --\x3e <a *ngIf="!menu.subItems && !this.isExternalLink(menu.link) && menu.link" class="thf-menu-item-link" (click)="clickMenuItem(menu)" [routerLink]="menu.link"> <div [ngClass]="{\'thf-menu-item\': true, \'thf-menu-item-selected\': menuItemActive === menu}"> {{ menu.label }} </div> </a> <a *ngIf="!menu.subItems && (this.isExternalLink(menu.link) || !menu.link)" class="thf-menu-item-link" (click)="$event.preventDefault();clickMenuItem(menu);" [href]="menu.link ? menu.link : \'javascript:;\'"> <div [ngClass]="{\'thf-menu-item\': true, \'thf-menu-item-selected\': menuItemActive === menu}"> {{ menu.label }} </div> </a> \x3c!-- item de menu com sub itens --\x3e <div *ngIf="menu.subItems"> <div (click)="clickMenuItemGrouped(menu)" class="thf-menu-item thf-clickable" [ngClass]="{ \'thf-menu-item-selected\': isMenuItemSelected(menu), \'thf-menu-item-grouper-up\': menu === menuItemOpened }"> \x3c!-- menu agrupado fechado --\x3e <div *ngIf="menu !== menuItemOpened" class="thf-menu-grouper-icon-down"> <span class="thf-icon thf-icon-arrow-down"></span> </div> \x3c!-- menu agrupado aberto --\x3e <div *ngIf="menu === menuItemOpened" class="thf-menu-grouper-icon-up"> <span class="thf-icon thf-icon-arrow-up"></span> </div> {{ menu.label }} </div> \x3c!-- sub itens menu agrupado --\x3e <div [ngClass]="{ \'thf-menu-sub-items-visible\': menu === menuItemOpened }" class="thf-menu-sub-items"> <div *ngFor="let subMenu of menu.subItems"> <a *ngIf="!this.isExternalLink(subMenu.link) && subMenu.link" class="thf-menu-item-link" [routerLink]="subMenu.link" (click)="clickSubMenuItem(subMenu)"> <div [ngClass]="{\'thf-menu-item\': true, \'thf-menu-item-selected\': menuItemActive === subMenu}"> {{ subMenu.label }} </div> </a> <a *ngIf="(this.isExternalLink(subMenu.link) || !subMenu.link)" class="thf-menu-item-link" [href]="subMenu.link ? subMenu.link : \'javascript:;\'" (click)="$event.preventDefault(); clickSubMenuItem(subMenu);"> <div [ngClass]="{\'thf-menu-item\': true, \'thf-menu-item-selected\': menuItemActive === subMenu}"> {{ subMenu.label }} </div> </a> </div> </div> </div> </div> </div> </div> </nav> </div> '}]}],n.ctorParameters=function(){return[{type:ElementRef},{type:ViewContainerRef},{type:Location},{type:Router}]},n}(ThfMenuBaseComponent);export{ThfMenuComponent};function ThfMenuComponent_tsickle_Closure_declarations(){ThfMenuComponent.decorators,ThfMenuComponent.ctorParameters,ThfMenuComponent.prototype.menuItemActive,ThfMenuComponent.prototype.linkActive,ThfMenuComponent.prototype.menuItemOpened,ThfMenuComponent.prototype.menuMobileOpened,ThfMenuComponent.prototype.parentRef,ThfMenuComponent.prototype.elementRef,ThfMenuComponent.prototype.viewRef,ThfMenuComponent.prototype.location,ThfMenuComponent.prototype.router}